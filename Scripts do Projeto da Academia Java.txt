USE projeto;

CREATE TABLE `endereco` (
	`id` BIGINT(20) PRIMARY KEY AUTO_INCREMENT,
	`logradouro` VARCHAR(50) NOT NULL,
	`numero` int(20) NOT NULL,
  	`complemento` VARCHAR(50),
	`bairro` VARCHAR(50) NOT NULL,
	`cidade` VARCHAR(50) NOT NULL,
	`estado` VARCHAR(50) NOT NULL,
	`cep` VARCHAR(9)
) ENGINE=InnoDB DEFAULT CHARSET=utf8;

CREATE TABLE `bar` (
	`id` BIGINT(20) PRIMARY KEY AUTO_INCREMENT,
	`nome` VARCHAR(50) NOT NULL,
	`cnpj` VARCHAR(18) NOT NULL,
	`contato` VARCHAR(15) NOT NULL,
	`email` VARCHAR(50),
	`dia_inicial` VARCHAR(13) NOT NULL,
	`dia_final` VARCHAR(13) NOT NULL,
	`horario_inicial` VARCHAR(5) NOT NULL,
	`horario_final` VARCHAR(5) NOT NULL,
	`tipo_musica` VARCHAR(50) DEFAULT NULL,
  	`tipo_comida` VARCHAR(50) DEFAULT NULL,
  	`tem_estacionamento` BOOLEAN NOT NULL,
	`estacionamento_pago` BOOLEAN NOT NULL,
	`tem_cover` BOOLEAN NOT NULL,
	`cover_pago` BOOLEAN NOT NULL,
  	`id_endereco` BIGINT(20) NOT NULL,
	FOREIGN KEY (id_endereco) REFERENCES endereco(id)
) ENGINE=InnoDB DEFAULT CHARSET=utf8;

create table if not exists usuario (
	id bigint not null auto_increment,
	nome varchar(100) not null,
	login varchar(50) not null,
	senha varchar(100) not null,
	ativo boolean default false,
	primary key (id),
	unique key un_usuario_login (login)
);

create table if not exists permissao (
	id bigint not null auto_increment,
	nome varchar(100) not null,
	primary key (id)
);

create table if not exists usuario_permissao (
	usuario_id bigint not null,
	permissao_id bigint not null,
	primary key (usuario_id, permissao_id),
	FOREIGN KEY (usuario_id) REFERENCES usuario(id),
	FOREIGN KEY (permissao_id) REFERENCES permissao(id)
);

insert into permissao (id, nome) values 
	(1, 'ROLE_PG_BUSCA_BARES'),
	(2, 'ROLE_PG_BARES')
;